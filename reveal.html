<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Secret Santa</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 22px; line-height: 1.35; }
      .btn {
        display: inline-block; padding: 12px 16px; border: 1px solid #222;
        border-radius: 10px; text-decoration: none; color: #111; font-weight: 600;
      }
      .muted { color: #666; margin-top: 10px; font-size: 13px; }
      code { background: #f4f4f4; padding: 2px 6px; border-radius: 6px; }
    </style>
  </head>

  <body>
    <h2>Secret Santa</h2>
    <div id="msg">Redirectingâ€¦</div>
    <div id="fallback" style="margin-top:14px;"></div>

    <script>
      const params = new URLSearchParams(window.location.search);
      const t = params.get("t");

      // Your Apps Script Web App URL (must end with /exec)
      const WEB_APP =
        "https://script.google.com/macros/s/AKfycbxOAoCEff173_F0_RmDWn72WY7ZTdEZgo7a8imNGKjqCsZGwBM3uE7JpmSDtcAM7DrR/exec";

      if (!t) {
        document.getElementById("msg").innerText =
          "Missing token. Please open the exact link you received.";
      } else {
        const target = `${WEB_APP}?t=${encodeURIComponent(t)}`;

        // Redirect immediately
        window.location.replace(target);

        // Fallback button (helps in restrictive in-app browsers)
        document.getElementById("fallback").innerHTML = `
          <a class="btn" href="${target}" target="_blank" rel="noopener">Tap here if not redirected</a>
          <div class="muted">
            If you see a Google Drive error, open this link in Safari/Chrome (not inside Drive/Gmail).
          </div>
        `;
      }
    </script>
  </body>
</html>
